# 멀티 휴리스틱 A* 알고리즘 (Multi-Heuristic A*)

이 문서는 `multi_heuristic_astar.py` 파일에 구현된 **Multi-Heuristic A* (MHA*)** 알고리즘에 대해 설명합니다.

## 개요

MHA* 알고리즘은 하나의 일관된(Consistent) 휴리스틱(Anchor)과 여러 개의 비일관적(Inadmissible) 휴리스틱을 동시에 사용하여 그래프 탐색을 수행하는 알고리즘입니다. 이를 통해 최적성(Optimality)에 대한 경계(Bound)를 유지하면서도 탐색 속도를 향상시킬 수 있습니다.

이 구현에서는 2차원 그리드 상에서 장애물을 피해 시작점에서 목표점까지 이동하는 경로를 찾습니다.

## 주요 클래스 및 함수

### `PriorityQueue` 클래스
- **목적**: 탐색할 노드들을 우선순위에 따라 관리하는 큐입니다.
- **특징**: `heapq` 모듈을 사용하며, 중복된 아이템의 업데이트 및 제거 기능을 포함하고 있습니다.

### 휴리스틱 함수들
- **`consistent_heuristic(P, goal)`**: 유클리드 거리(Euclidean Distance)를 계산합니다. (Anchor 역할)
- **`heuristic_1(P, goal)`**: 맨해튼 거리(Manhattan Distance)를 계산합니다.
- **`heuristic_2(P, goal)`**: 시간 변수 `t`로 나눈 유클리드 거리를 계산합니다.

### `multi_a_star(start, goal, n_heuristic)`
- **목적**: MHA* 알고리즘의 메인 루프를 실행합니다.
- **동작 원리**:
  1. 각 휴리스틱마다 별도의 우선순위 큐(`open_list`)를 생성합니다.
  2. **Anchor 큐(0번)**와 **비일관적 큐들(1~n번)**을 관리합니다.
  3. 루프를 돌며 다음 규칙에 따라 노드를 선택하여 확장합니다:
     - 비일관적 휴리스틱 $i$의 최소 키 값이 Anchor 휴리스틱의 최소 키 값의 $W2$배보다 작거나 같다면 (`open_list[i].minkey() <= W2 * open_list[0].minkey()`), 해당 큐에서 노드를 선택합니다.
     - 그렇지 않다면, Anchor 큐에서 노드를 선택합니다.
  4. 목표에 도달하면 `do_something` 함수를 호출하여 경로를 출력하고 종료합니다.

### `expand_state(...)`
- **목적**: 선택된 노드(`s`)의 이웃 노드들을 확인하고 큐에 추가하거나 갱신합니다.
- **동작**:
  - 상, 하, 좌, 우 4방향의 이웃을 확인합니다.
  - 장애물이 아니고 그리드 범위 내에 있는 경우:
    - $g(n)$ 값을 갱신합니다.
    - Anchor 큐에 추가합니다.
    - 비일관적 큐에는 특정 조건($key(n, i) \le W2 \cdot key(n, 0)$)을 만족할 때만 추가합니다.

### `do_something(back_pointer, goal, start)`
- **목적**: 탐색이 완료되었을 때 경로를 역추적하고 시각화하여 출력합니다.
- **출력**:
  - `*`: 빈 공간
  - `#`: 장애물
  - `-`: 알고리즘이 찾은 경로
  - 경로의 좌표 리스트

## 주요 파라미터

- `n`: 그리드의 크기 (20x20).
- `blocks`: 장애물의 위치 리스트.
- `W1`, `W2`: 휴리스틱 가중치 파라미터.
- `start`, `goal`: 시작점과 목표점 좌표.

## 사용법

`if __name__ == "__main__":` 블록에서 알고리즘이 실행됩니다.

```python
# 실행 시 그리드 맵과 찾은 경로, 좌표들이 출력됩니다.
multi_a_star(start, goal, n_heuristic)
```
