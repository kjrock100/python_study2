# 세피아 톤 변환 (Sepia Tone Conversion)

이 문서는 `sepia.py` 파일에 구현된 **세피아 톤(Sepia Tone)** 변환 알고리즘에 대해 설명합니다. 이 코드는 OpenCV를 사용하여 컬러 이미지를 오래된 사진 느낌이 나는 갈색 톤(세피아)으로 변환합니다.

## 개요

세피아 효과는 이미지를 그레이스케일(회색조)로 변환한 뒤, 붉은색과 녹색 성분을 추가하여 따뜻한 갈색 느낌을 주는 기법입니다.

## 주요 함수: `make_sepia`

### `make_sepia(img, factor: int)`
- **목적**: 입력 이미지에 세피아 필터를 적용합니다.
- **매개변수**:
  - `img`: OpenCV로 읽어온 이미지 객체 (NumPy 배열, BGR 포맷).
  - `factor`: 세피아 톤의 강도를 조절하는 정수 값. 값이 클수록 더 진한 갈색이 됩니다.
- **반환값**: 변환된 이미지.

### 내부 헬퍼 함수

1. **`to_grayscale(blue, green, red)`**:
   - 컬러 픽셀을 그레이스케일 명도 값으로 변환합니다.
   - **공식**: $0.2126 \cdot R + 0.587 \cdot G + 0.114 \cdot B$ (인간의 눈이 느끼는 밝기 기여도를 반영한 가중치)

2. **`normalize(value)`**:
   - 계산된 색상 값이 255를 초과하지 않도록 제한합니다 (`min(value, 255)`).

### 알고리즘 동작 원리

1. 이미지의 높이와 너비를 구하여 모든 픽셀을 이중 반복문으로 순회합니다.
2. 각 픽셀(`img[i][j]`)의 B, G, R 값을 가져와 `to_grayscale` 함수로 회색조 값(`greyscale`)을 계산합니다.
3. 회색조 값을 기반으로 새로운 B, G, R 값을 할당하여 세피아 톤을 만듭니다.
   - **Blue**: `greyscale` (변화 없음)
   - **Green**: `greyscale + factor` (녹색 성분 추가)
   - **Red**: `greyscale + 2 * factor` (붉은색 성분을 더 많이 추가하여 갈색 톤 형성)
   - *참고*: OpenCV는 이미지를 **BGR** 순서로 저장하므로 코드에서는 `[Blue, Green, Red]` 순서로 값을 대입합니다.

## 사용법

`if __name__ == "__main__":` 블록에서 사용 예시를 확인할 수 있습니다:

1. `image_data/lena.jpg` 이미지를 불러옵니다.
2. 10, 20, 30, 40의 서로 다른 `factor` 값을 사용하여 `make_sepia` 함수를 호출합니다.
3. 변환된 4개의 이미지를 각각 윈도우에 띄워 결과를 비교합니다.
4. 아무 키나 누르면 모든 창이 닫힙니다.

## 참고 사항

- **성능**: 이 코드는 교육 목적으로 작성되어 Python의 이중 `for` 루프를 사용하여 픽셀을 직접 조작합니다. 이는 속도가 느리므로, 실무에서는 NumPy의 브로드캐스팅이나 OpenCV의 행렬 연산(`cv2.transform` 등)을 사용하는 것이 효율적입니다.
