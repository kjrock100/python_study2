# `fenwick_tree.py` 코드 설명

이 문서는 `fenwick_tree.py` 스크립트에 구현된 펜윅 트리(Fenwick Tree) 또는 이진 인덱스 트리(Binary Indexed Tree, BIT)에 대해 설명합니다.

## 1. 펜윅 트리란?

펜윅 트리는 배열의 특정 구간의 합(Prefix Sum)을 효율적으로 계산하고, 배열의 특정 원소 값을 동적으로 업데이트하는 데 사용되는 자료 구조입니다.

주요 특징은 다음과 같습니다.
-   **구간 합 계산 (Query)**: O(log N)
-   **원소 값 업데이트 (Update)**: O(log N)

일반 배열에서 구간 합을 구하려면 O(N)이 걸리고, 구간 합 배열(Prefix Sum Array)을 사용하면 업데이트에 O(N)이 걸리는 단점을 보완한 효율적인 자료 구조입니다.

> **중요**: 이 구현은 **1-기반 인덱싱(1-based indexing)**을 가정하고 동작합니다. 즉, 인덱스 `i`는 1부터 시작합니다.

## 2. 클래스 및 메서드 설명

### `FenwickTree` 클래스

펜윅 트리의 모든 기능을 포함하는 클래스입니다.

#### `__init__(self, SIZE)`
-   **역할**: `SIZE` 크기의 펜윅 트리를 생성하고 모든 값을 0으로 초기화합니다.
-   **매개변수**:
    -   `SIZE`: 트리가 다룰 수 있는 최대 인덱스 + 1. 예를 들어, 1부터 100까지의 인덱스를 사용하려면 `SIZE`는 101 이상이어야 합니다.

#### `update(self, i, val)`
-   **역할**: 배열의 `i`번째 원소에 `val`만큼의 변화를 줍니다 (값을 더합니다).
-   **동작 원리**:
    1.  `i`번 인덱스에서 시작하여, 해당 인덱스가 담당하는 구간 합을 업데이트합니다.
    2.  `i`에 `i`의 '마지막 비트'(`i & -i`)를 더하여 다음으로 업데이트해야 할 부모 노드로 이동합니다.
    3.  트리의 범위를 벗어날 때까지 이 과정을 반복합니다.
-   **시간 복잡도**: O(log N)

#### `query(self, i)`
-   **역할**: 1번째 원소부터 `i`번째 원소까지의 누적 합(Prefix Sum)을 계산합니다.
-   **동작 원리**:
    1.  `i`번 인덱스에서 시작하여, 결과값에 현재 트리 노드의 값을 더합니다.
    2.  `i`에서 `i`의 '마지막 비트'(`i & -i`)를 빼서 이전 구간의 합을 담당하는 노드로 이동합니다.
    3.  `i`가 0이 될 때까지 이 과정을 반복합니다.
-   **시간 복잡도**: O(log N)

## 3. 사용 예제

### 기본 사용법

```python
if __name__ == "__main__":
    # 1부터 99까지의 인덱스를 사용할 수 있는 펜윅 트리 생성
    f = FenwickTree(100)

    # 1번 인덱스에 20을 더함
    f.update(1, 20)
    # 4번 인덱스에 4를 더함
    f.update(4, 4)

    # 1번까지의 누적 합: 20
    print(f.query(1))

    # 3번까지의 누적 합: 20 (1번 값)
    print(f.query(3))

    # 4번까지의 누적 합: 24 (1번 값 + 4번 값)
    print(f.query(4))

    # 2번 인덱스에 -5를 더함
    f.update(2, -5)

    # 1번까지의 누적 합: 20
    print(f.query(1))

    # 3번까지의 누적 합: 15 (1번 값 + 2번 값)
    print(f.query(3))
```

### 특정 구간의 합 구하기

`query` 메서드를 응용하여 특정 구간 `[a, b]`의 합을 구할 수 있습니다.

> **구간 `[a, b]`의 합 = `query(b) - query(a - 1)`**

```python
# 2번부터 4번까지의 합을 구하는 예시
sum_2_to_4 = f.query(4) - f.query(1)
print(f"Sum from index 2 to 4: {sum_2_to_4}")
# 출력: Sum from index 2 to 4: -1 (2번 값(-5) + 4번 값(4))
```