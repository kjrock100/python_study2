# MD5 해시 알고리즘 (MD5 Hash Algorithm)

이 문서는 `md5.py` 파일에 구현된 **MD5 (Message-Digest Algorithm 5)** 해시 알고리즘에 대해 설명합니다.

## 개요

MD5는 임의의 길이의 메시지를 입력받아 128비트(32자리 16진수)의 고정된 길이의 해시값을 출력하는 암호화 해시 함수입니다. 1991년 Ronald Rivest가 설계했습니다. 현재는 충돌 저항성 문제로 인해 보안 관련 용도로는 권장되지 않지만, 데이터 무결성 검증 등 비보안 용도로 여전히 사용됩니다.

## 주요 함수

### 헬퍼 함수
- **`rearrange(bitString32)`**: 32비트 이진 문자열의 바이트 순서를 리틀 엔디안(Little-endian) 방식으로 재배열합니다.
- **`reformatHex(i)`**: 정수를 8자리 16진수 문자열로 변환하고 바이트 순서를 조정합니다.
- **`pad(bitString)`**: 입력 메시지의 길이를 512비트의 배수가 되도록 패딩(Padding)합니다. 메시지 끝에 '1'을 추가하고, 나머지를 '0'으로 채운 뒤, 마지막 64비트에 원본 메시지의 길이를 추가합니다.
- **`getBlock(bitString)`**: 패딩된 전체 비트 문자열을 512비트(16개의 32비트 워드) 단위의 블록으로 나누어 반환하는 제너레이터입니다.
- **비트 연산 함수**:
  - `not32(i)`: 32비트 NOT 연산.
  - `sum32(a, b)`: 32비트 덧셈 (모듈러 $2^{32}$).
  - `leftrot32(i, s)`: 32비트 좌측 순환 시프트(Left Rotate).

### `md5me(testString)`

- **목적**: 입력 문자열에 대한 MD5 해시값을 계산합니다.
- **매개변수**:
  - `testString`: 해시할 입력 문자열.
- **반환값**: 32자리 16진수 해시 문자열.

### 알고리즘 동작 원리 (`md5me`)

1. **초기화**:
   - 4개의 32비트 레지스터 `A`, `B`, `C`, `D`를 특정 상수로 초기화합니다.
   - 라운드별 시프트 양(`s`)과 상수(`tvals`, 사인 함수 기반)를 정의합니다.

2. **전처리**:
   - 입력 문자열을 이진 문자열로 변환하고 `pad` 함수를 통해 패딩합니다.

3. **블록 처리 루프**:
   - 512비트 블록마다 다음 과정을 반복합니다.
   - `A`, `B`, `C`, `D`의 현재 값을 저장해둡니다.
   - 64회의 연산을 수행합니다 (4라운드 $\times$ 16단계). 각 라운드마다 다른 비선형 함수(`F`, `G`, `H`, `I`)를 사용합니다.
     - 라운드 1 (0~15): $F(B, C, D) = (B \land C) \lor (\neg B \land D)$
     - 라운드 2 (16~31): $G(B, C, D) = (D \land B) \lor (\neg D \land C)$
     - 라운드 3 (32~47): $H(B, C, D) = B \oplus C \oplus D$
     - 라운드 4 (48~63): $I(B, C, D) = C \oplus (B \lor \neg D)$
   - 각 단계에서 `A`, `B`, `C`, `D` 값을 갱신하고 회전시킵니다.
   - 64회 연산 후, 초기값에 현재 계산된 값을 더합니다.

4. **결과 생성**:
   - 최종 `A`, `B`, `C`, `D` 값을 연결하여 128비트 해시값을 생성하고 반환합니다.

## 사용법

`if __name__ == "__main__":` 블록에서 `test()` 함수를 호출하여 예제 케이스를 검증합니다.

```python
# 빈 문자열 해시
assert md5me("") == "d41d8cd98f00b204e9800998ecf8427e"

# 일반 문자열 해시
assert md5me("The quick brown fox jumps over the lazy dog") == "9e107d9d372bb6826bd81d3542a419d6"
```
